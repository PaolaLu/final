{"ast":null,"code":"import custom_axios from '../plugins/axios.js';\nexport default {\n  props: {\n    horario: {\n      type: Object,\n      default: () => ({\n        id: \"\",\n        id_materia: \"\",\n        fh_desde: \"\",\n        fh_hasta: \"\"\n      })\n    },\n    editar: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      valid: false,\n      horarioData: {\n        id_materia: \"\",\n        fh_desde: \"\",\n        fh_hasta: \"\"\n      },\n      fechaDesde: \"\",\n      horaDesde: \"\",\n      fechaHasta: \"\",\n      horaHasta: \"\",\n      materias: [],\n      materiaRules: [v => !!v || 'La materia es requerida'],\n      desdeRules: [v => !!v || 'La fecha de inicio es requerida'],\n      hastaRules: [v => !!v || 'La fecha de fin es requerida'],\n      horaRules: [v => !!v || 'La hora es requerida'],\n      menuDesde: false,\n      menuHasta: false\n    };\n  },\n  watch: {\n    horario: {\n      handler(nuevoValor) {\n        console.log(\"Nuevo valor de horario:\", nuevoValor);\n        this.horarioData = {\n          ...nuevoValor\n        };\n        if (this.horarioData.fh_desde) {\n          const desde = new Date(this.horarioData.fh_desde);\n          this.fechaDesde = this.formatDate(desde);\n          this.horaDesde = this.formatTime(desde);\n        }\n        if (this.horarioData.fh_hasta) {\n          const hasta = new Date(this.horarioData.fh_hasta);\n          this.fechaHasta = this.formatDate(hasta);\n          this.horaHasta = this.formatTime(hasta);\n        }\n        if (!this.editar) {\n          this.resetValidation();\n        }\n        console.log(\"Fecha Desde:\", this.fechaDesde);\n        console.log(\"Hora Desde:\", this.horaDesde);\n        console.log(\"Fecha Hasta:\", this.fechaHasta);\n        console.log(\"Hora Hasta:\", this.horaHasta);\n      },\n      deep: true,\n      immediate: true\n    },\n    fechaDesde(newVal) {\n      console.log(\"Fecha Desde cambiada:\", newVal);\n    },\n    fechaHasta(newVal) {\n      console.log(\"Fecha Hasta cambiada:\", newVal);\n    }\n  },\n  methods: {\n    formatDate(date) {\n      if (!date) return null;\n      const d = new Date(date);\n      return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')}`;\n    },\n    formatTime(date) {\n      if (!date) return null;\n      const d = new Date(date);\n      return `${String(d.getHours()).padStart(2, '0')}:${String(d.getMinutes()).padStart(2, '0')}`;\n    },\n    updateDateTime() {\n      console.log(\"Actualizando DateTime\");\n      console.log(\"Fecha Desde:\", this.fechaDesde);\n      console.log(\"Hora Desde:\", this.horaDesde);\n      this.horarioData.fh_desde = `${this.fechaDesde}T${this.horaDesde}:00`;\n      this.horarioData.fh_hasta = `${this.fechaHasta}T${this.horaHasta}:00`;\n      console.log(\"fh_desde actualizado:\", this.horarioData.fh_desde);\n      console.log(\"fh_hasta actualizado:\", this.horarioData.fh_hasta);\n    },\n    submit() {\n      console.log(\"Intentando enviar el formulario\");\n      this.$refs.form.validate();\n      if (this.valid) {\n        console.log(\"Formulario válido, actualizando DateTime\");\n        this.updateDateTime();\n        if (this.editar) {\n          this.editarHorario();\n        } else {\n          this.guardarHorario();\n        }\n      } else {\n        console.log(\"Formulario no válido\");\n      }\n    },\n    guardarHorario() {\n      console.log(\"Guardando horario:\", this.horarioData);\n      custom_axios.post('/apiv1/horariomateria', this.horarioData).then(response => {\n        console.log(\"Horario guardado exitosamente:\", response.data);\n        this.$emit('guardar');\n        this.$emit('cerrar');\n      }).catch(error => {\n        console.error('Error guardando horario:', error);\n      });\n    },\n    editarHorario() {\n      console.log(\"Editando horario:\", this.horarioData);\n      custom_axios.patch(`/apiv1/horariomateria/${this.horarioData.id}`, this.horarioData).then(response => {\n        console.log(\"Horario editado exitosamente:\", response.data);\n        this.$emit('guardar');\n        this.$emit('cerrar');\n      }).catch(error => {\n        console.error('Error editando horario:', error);\n      });\n    },\n    cancelar() {\n      this.$emit('cancelar');\n    },\n    resetValidation() {\n      if (this.$refs.form) {\n        this.$refs.form.resetValidation();\n      }\n    },\n    obtenerMaterias() {\n      custom_axios.get('/apiv1/materia').then(response => {\n        this.materias = response.data;\n        console.log(\"Materias obtenidas:\", this.materias);\n      }).catch(error => {\n        console.error('Error obteniendo materias:', error);\n      });\n    }\n  },\n  created() {\n    console.log(\"Componente AbmHorarioMateria creado\");\n    this.obtenerMaterias();\n    if (this.horario) {\n      this.horarioData = {\n        ...this.horario\n      };\n    }\n  }\n};","map":{"version":3,"names":["custom_axios","props","horario","type","Object","default","id","id_materia","fh_desde","fh_hasta","editar","Boolean","data","valid","horarioData","fechaDesde","horaDesde","fechaHasta","horaHasta","materias","materiaRules","v","desdeRules","hastaRules","horaRules","menuDesde","menuHasta","watch","handler","nuevoValor","console","log","desde","Date","formatDate","formatTime","hasta","resetValidation","deep","immediate","newVal","methods","date","d","getFullYear","String","getMonth","padStart","getDate","getHours","getMinutes","updateDateTime","submit","$refs","form","validate","editarHorario","guardarHorario","post","then","response","$emit","catch","error","patch","cancelar","obtenerMaterias","get","created"],"sources":["src/components/AbmHorarioMateria.vue"],"sourcesContent":["<template>\n    <v-form ref=\"form\" v-model=\"valid\" @submit.prevent=\"submit\">\n      <v-card>\n        <v-card-title>{{ editar ? 'Editar Horario de Materia' : 'Agregar Horario de Materia' }}</v-card-title>\n        <v-card-text>\n          <v-select\n            v-model=\"horarioData.id_materia\"\n            :items=\"materias\"\n            item-text=\"nombre\"\n            item-value=\"id\"\n            label=\"Materia\"\n            :rules=\"materiaRules\"\n            required\n          ></v-select>\n          \n          <!-- Desde -->\n          <v-row>\n            <v-col cols=\"12\" sm=\"6\">\n              <v-menu\n                v-model=\"menuDesde\"\n                :close-on-content-click=\"false\"\n                transition=\"scale-transition\"\n                offset-y\n                min-width=\"290px\"\n              >\n                <template v-slot:activator=\"{ on, attrs }\">\n                  <v-text-field\n                    v-model=\"fechaDesde\"\n                    label=\"Fecha Desde\"\n                    prepend-icon=\"mdi-calendar\"\n                    readonly\n                    v-bind=\"attrs\"\n                    v-on=\"on\"\n                    :rules=\"desdeRules\"\n                    required\n                  ></v-text-field>\n                </template>\n                <v-date-picker\n                  v-model=\"fechaDesde\"\n                  @input=\"menuDesde = false\"\n                ></v-date-picker>\n              </v-menu>\n            </v-col>\n            <v-col cols=\"12\" sm=\"6\">\n              <v-text-field\n                v-model=\"horaDesde\"\n                label=\"Hora Desde\"\n                type=\"time\"\n                prepend-icon=\"mdi-clock-outline\"\n                :rules=\"horaRules\"\n                required\n              ></v-text-field>\n            </v-col>\n          </v-row>\n  \n          <!-- Hasta -->\n          <v-row>\n            <v-col cols=\"12\" sm=\"6\">\n              <v-menu\n                v-model=\"menuHasta\"\n                :close-on-content-click=\"false\"\n                transition=\"scale-transition\"\n                offset-y\n                min-width=\"290px\"\n              >\n                <template v-slot:activator=\"{ on, attrs }\">\n                  <v-text-field\n                    v-model=\"fechaHasta\"\n                    label=\"Fecha Hasta\"\n                    prepend-icon=\"mdi-calendar\"\n                    readonly\n                    v-bind=\"attrs\"\n                    v-on=\"on\"\n                    :rules=\"hastaRules\"\n                    required\n                  ></v-text-field>\n                </template>\n                <v-date-picker\n                  v-model=\"fechaHasta\"\n                  @input=\"menuHasta = false\"\n                ></v-date-picker>\n              </v-menu>\n            </v-col>\n            <v-col cols=\"12\" sm=\"6\">\n              <v-text-field\n                v-model=\"horaHasta\"\n                label=\"Hora Hasta\"\n                type=\"time\"\n                prepend-icon=\"mdi-clock-outline\"\n                :rules=\"horaRules\"\n                required\n              ></v-text-field>\n            </v-col>\n          </v-row>\n        </v-card-text>\n        <v-card-actions>\n          <v-btn color=\"primary\" @click=\"submit\" :disabled=\"!valid\">Guardar</v-btn>\n          <v-btn color=\"secondary\" @click=\"cancelar\">Cancelar</v-btn>\n        </v-card-actions>\n      </v-card>\n    </v-form>\n  </template>\n  \n  <script>\n  import custom_axios from '../plugins/axios.js';\n  \n  export default {\n    props: {\n      horario: {\n        type: Object,\n        default: () => ({ id: \"\", id_materia: \"\", fh_desde: \"\", fh_hasta: \"\" }),\n      },\n      editar: {\n        type: Boolean,\n        default: false,\n      },\n    },\n    data() {\n      return {\n        valid: false,\n        horarioData: {\n          id_materia: \"\",\n          fh_desde: \"\",\n          fh_hasta: \"\",\n        },\n        fechaDesde: \"\",\n        horaDesde: \"\",\n        fechaHasta: \"\",\n        horaHasta: \"\",\n        materias: [],\n        materiaRules: [(v) => !!v || 'La materia es requerida'],\n        desdeRules: [(v) => !!v || 'La fecha de inicio es requerida'],\n        hastaRules: [(v) => !!v || 'La fecha de fin es requerida'],\n        horaRules: [(v) => !!v || 'La hora es requerida'],\n        menuDesde: false,\n        menuHasta: false,\n      };\n    },\n    watch: {\n      horario: {\n        handler(nuevoValor) {\n          console.log(\"Nuevo valor de horario:\", nuevoValor);\n          this.horarioData = { ...nuevoValor };\n          if (this.horarioData.fh_desde) {\n            const desde = new Date(this.horarioData.fh_desde);\n            this.fechaDesde = this.formatDate(desde);\n            this.horaDesde = this.formatTime(desde);\n          }\n          if (this.horarioData.fh_hasta) {\n            const hasta = new Date(this.horarioData.fh_hasta);\n            this.fechaHasta = this.formatDate(hasta);\n            this.horaHasta = this.formatTime(hasta);\n          }\n          if (!this.editar) {\n            this.resetValidation();\n          }\n          console.log(\"Fecha Desde:\", this.fechaDesde);\n          console.log(\"Hora Desde:\", this.horaDesde);\n          console.log(\"Fecha Hasta:\", this.fechaHasta);\n          console.log(\"Hora Hasta:\", this.horaHasta);\n        },\n        deep: true,\n        immediate: true\n      },\n      fechaDesde(newVal) {\n        console.log(\"Fecha Desde cambiada:\", newVal);\n      },\n      fechaHasta(newVal) {\n        console.log(\"Fecha Hasta cambiada:\", newVal);\n      }\n    },\n    methods: {\n      formatDate(date) {\n        if (!date) return null;\n        const d = new Date(date);\n        return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')}`;\n      },\n      formatTime(date) {\n        if (!date) return null;\n        const d = new Date(date);\n        return `${String(d.getHours()).padStart(2, '0')}:${String(d.getMinutes()).padStart(2, '0')}`;\n      },\n      updateDateTime() {\n        console.log(\"Actualizando DateTime\");\n        console.log(\"Fecha Desde:\", this.fechaDesde);\n        console.log(\"Hora Desde:\", this.horaDesde);\n        this.horarioData.fh_desde = `${this.fechaDesde}T${this.horaDesde}:00`;\n        this.horarioData.fh_hasta = `${this.fechaHasta}T${this.horaHasta}:00`;\n        console.log(\"fh_desde actualizado:\", this.horarioData.fh_desde);\n        console.log(\"fh_hasta actualizado:\", this.horarioData.fh_hasta);\n      },\n      submit() {\n        console.log(\"Intentando enviar el formulario\");\n        this.$refs.form.validate();\n        if (this.valid) {\n          console.log(\"Formulario válido, actualizando DateTime\");\n          this.updateDateTime();\n          if (this.editar) {\n            this.editarHorario();\n          } else {\n            this.guardarHorario();\n          }\n        } else {\n          console.log(\"Formulario no válido\");\n        }\n      },\n      guardarHorario() {\n        console.log(\"Guardando horario:\", this.horarioData);\n        custom_axios\n          .post('/apiv1/horariomateria', this.horarioData)\n          .then((response) => {\n            console.log(\"Horario guardado exitosamente:\", response.data);\n            this.$emit('guardar');\n            this.$emit('cerrar');\n          })\n          .catch((error) => {\n            console.error('Error guardando horario:', error);\n          });\n      },\n      editarHorario() {\n        console.log(\"Editando horario:\", this.horarioData);\n        custom_axios\n          .patch(`/apiv1/horariomateria/${this.horarioData.id}`, this.horarioData)\n          .then((response) => {\n            console.log(\"Horario editado exitosamente:\", response.data);\n            this.$emit('guardar');\n            this.$emit('cerrar');\n          })\n          .catch((error) => {\n            console.error('Error editando horario:', error);\n          });\n      },\n      cancelar() {\n        this.$emit('cancelar');\n      },\n      resetValidation() {\n        if (this.$refs.form) {\n          this.$refs.form.resetValidation();\n        }\n      },\n      obtenerMaterias() {\n        custom_axios\n          .get('/apiv1/materia')\n          .then((response) => {\n            this.materias = response.data;\n            console.log(\"Materias obtenidas:\", this.materias);\n          })\n          .catch((error) => {\n            console.error('Error obteniendo materias:', error);\n          });\n      },\n    },\n    created() {\n      console.log(\"Componente AbmHorarioMateria creado\");\n      this.obtenerMaterias();\n      if (this.horario) {\n        this.horarioData = { ...this.horario };\n      }\n    },\n  };\n  </script>\n  \n  <style scoped>\n  .mr-2 {\n    margin-right: 8px;\n  }\n  .ml-2 {\n    margin-left: 8px;\n  }\n  </style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}