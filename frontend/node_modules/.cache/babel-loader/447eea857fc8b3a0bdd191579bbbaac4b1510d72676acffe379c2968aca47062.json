{"ast":null,"code":"import custom_axios from '../plugins/axios.js';\nimport AbmMateria from './AbmMateria.vue';\nexport default {\n  components: {\n    AbmMateria\n  },\n  data() {\n    return {\n      cantTotalListadoMaterias: 0,\n      loading: true,\n      options: {},\n      headers: [{\n        text: \"ID\",\n        value: \"id\"\n      }, {\n        text: \"Nombre\",\n        value: \"nombre\"\n      }, {\n        text: \"Cantidad de alumnos\",\n        value: \"cant_alumnos\"\n      }, {\n        text: \"Carrera\",\n        value: \"carrera\"\n      }, {\n        text: \"Profesor\",\n        value: \"profesor\"\n      }, {\n        text: \"Acciones\",\n        value: \"actions\",\n        sortable: false\n      }],\n      footerProps: {\n        \"items-per-page-options\": [10, 25, 50]\n      },\n      listadoMaterias: [],\n      mostrarAbmMaterias: false,\n      materiaSeleccionada: {},\n      editar: false\n    };\n  },\n  watch: {\n    options: {\n      handler() {\n        this.obtenerListadoDeApi();\n      },\n      deep: true\n    }\n  },\n  methods: {\n    obtenerListadoDeApi() {\n      const {\n        sortBy,\n        sortDesc,\n        page,\n        itemsPerPage\n      } = this.options;\n      let sortMode = \"\";\n      if (sortDesc[0]) {\n        sortMode = \"-\";\n      }\n      const that = this;\n      custom_axios.get(`/apiv1/materia?per-page=${itemsPerPage}&page=${page}&sort=${sortMode}${sortBy}`).then(response => {\n        if (response.status === 200) {\n          const materias = response.data;\n          const promises = materias.map(materia => {\n            const carreraPromise = custom_axios.get(`/apiv1/carrera/${materia.id_carrera}`);\n            const profesorPromise = custom_axios.get(`/apiv1/profesor/${materia.id_profesor}`);\n            return Promise.all([carreraPromise, profesorPromise]);\n          });\n          Promise.all(promises).then(results => {\n            const updatedMaterias = results.map(([carreraResponse, profesorResponse], index) => {\n              const materia = materias[index];\n              materia.carrera = carreraResponse.data.nombre;\n              materia.profesor = `${profesorResponse.data.nombre} ${profesorResponse.data.apellido}`;\n              return materia;\n            });\n            that.listadoMaterias = updatedMaterias;\n            that.cantTotalListadoMaterias = parseInt(response.headers[\"x-pagination-total-count\"]);\n          }).catch(error => {\n            console.log(error);\n          }).finally(() => {\n            that.loading = false;\n          });\n        }\n      }).catch(error => {\n        console.log(error);\n      });\n    },\n    mostrarFormularioAbmMaterias() {\n      this.mostrarAbmMaterias = true;\n    },\n    agregarMateria() {\n      this.editar = false;\n      this.materiaSeleccionada = {};\n      this.mostrarFormularioAbmMaterias();\n    },\n    editarMateria(materia) {\n      this.materiaSeleccionada = {\n        id: materia.id,\n        nombre: materia.nombre,\n        cant_alumnos: materia.cant_alumnos,\n        id_carrera: materia.id_carrera,\n        id_profesor: materia.id_profesor\n      };\n      this.editar = true;\n      this.mostrarAbmMaterias = true;\n    },\n    guardarAbmMateria() {\n      this.mostrarAbmMaterias = false;\n      this.obtenerListadoDeApi(); // Llama a la función después de guardar\n    },\n    eliminarMateria(materia) {\n      const that = this;\n      custom_axios.delete(`/apiv1/materia/${materia.id}`).then(response => {\n        console.log(response);\n        alert(\"Registro Eliminado!!\");\n      }).catch(error => {\n        console.log(error);\n      }).finally(() => {\n        that.obtenerListadoDeApi(); // Asegúrate de que esta función se llame correctamente\n      });\n    },\n    cancelarAbmMateria() {\n      this.mostrarAbmMaterias = false;\n      this.materiaSeleccionada = {};\n    }\n  },\n  created() {\n    this.obtenerListadoDeApi(); // Asegúrate de que esta función se llame correctamente en el hook created\n  }\n};","map":{"version":3,"names":["custom_axios","AbmMateria","components","data","cantTotalListadoMaterias","loading","options","headers","text","value","sortable","footerProps","listadoMaterias","mostrarAbmMaterias","materiaSeleccionada","editar","watch","handler","obtenerListadoDeApi","deep","methods","sortBy","sortDesc","page","itemsPerPage","sortMode","that","get","then","response","status","materias","promises","map","materia","carreraPromise","id_carrera","profesorPromise","id_profesor","Promise","all","results","updatedMaterias","carreraResponse","profesorResponse","index","carrera","nombre","profesor","apellido","parseInt","catch","error","console","log","finally","mostrarFormularioAbmMaterias","agregarMateria","editarMateria","id","cant_alumnos","guardarAbmMateria","eliminarMateria","delete","alert","cancelarAbmMateria","created"],"sources":["src/components/ListadoMateria.vue"],"sourcesContent":["<template>\n  <div>\n    <v-data-table\n      :headers=\"headers\"\n      :items=\"listadoMaterias\"\n      :options.sync=\"options\"\n      :server-items-length=\"cantTotalListadoMaterias\"\n      :loading=\"loading\"\n      :footer-props=\"footerProps\"\n      sort-by=\"id\"\n      class=\"elevation-1\"\n    >\n      <template v-slot:top>\n        <v-toolbar flat>\n          <v-toolbar-title>Listado Materias</v-toolbar-title>\n          <v-divider class=\"mx-4\" inset vertical></v-divider>\n          <v-spacer></v-spacer>\n          <v-btn color=\"primary\" @click=\"agregarMateria\">Agregar Materia</v-btn>\n        </v-toolbar>\n      </template>\n      <template v-slot:item.actions=\"{ item }\">\n        <v-icon small class=\"mr-2\" @click=\"editarMateria(item)\">\n          mdi-pencil\n        </v-icon>\n        <v-icon small @click=\"eliminarMateria(item)\">mdi-delete</v-icon>\n      </template>\n    </v-data-table>\n\n    <v-dialog v-model=\"mostrarAbmMaterias\" max-width=\"500px\">\n      <AbmMateria\n        :materia=\"materiaSeleccionada\"\n        :editar=\"editar\"\n        @guardar=\"guardarAbmMateria\"\n        @cancelar=\"cancelarAbmMateria\"\n      />\n    </v-dialog>\n  </div>\n</template>\n\n<script>\nimport custom_axios from '../plugins/axios.js';\nimport AbmMateria from './AbmMateria.vue';\n\nexport default {\n  components: {\n    AbmMateria,\n  },\n  data() {\n    return {\n      cantTotalListadoMaterias: 0,\n      loading: true,\n      options: {},\n      headers: [\n        { text: \"ID\", value: \"id\" },\n        { text: \"Nombre\", value: \"nombre\" },\n        { text: \"Cantidad de alumnos\", value: \"cant_alumnos\" },\n        { text: \"Carrera\", value: \"carrera\" },\n        { text: \"Profesor\", value: \"profesor\" },\n        { text: \"Acciones\", value: \"actions\", sortable: false },\n      ],\n      footerProps: {\n        \"items-per-page-options\": [10, 25, 50],\n      },\n      listadoMaterias: [],\n      mostrarAbmMaterias: false,\n      materiaSeleccionada: {},\n      editar: false,\n    };\n  },\n  watch: {\n    options: {\n      handler() {\n        this.obtenerListadoDeApi();\n      },\n      deep: true,\n    },\n  },\n  methods: {\n    obtenerListadoDeApi() {\n      const { sortBy, sortDesc, page, itemsPerPage } = this.options;\n      let sortMode = \"\";\n      if (sortDesc[0]) {\n        sortMode = \"-\";\n      }\n      const that = this;\n\n      custom_axios\n        .get(`/apiv1/materia?per-page=${itemsPerPage}&page=${page}&sort=${sortMode}${sortBy}`)\n        .then((response) => {\n          if (response.status === 200) {\n            const materias = response.data;\n\n            const promises = materias.map((materia) => {\n              const carreraPromise = custom_axios.get(`/apiv1/carrera/${materia.id_carrera}`);\n              const profesorPromise = custom_axios.get(`/apiv1/profesor/${materia.id_profesor}`);\n\n              return Promise.all([carreraPromise, profesorPromise]);\n            });\n\n            Promise.all(promises)\n              .then((results) => {\n                const updatedMaterias = results.map(([carreraResponse, profesorResponse], index) => {\n                  const materia = materias[index];\n                  materia.carrera = carreraResponse.data.nombre;\n                  materia.profesor = `${profesorResponse.data.nombre} ${profesorResponse.data.apellido}`;\n                  return materia;\n                });\n\n                that.listadoMaterias = updatedMaterias;\n                that.cantTotalListadoMaterias = parseInt(response.headers[\"x-pagination-total-count\"]);\n              })\n              .catch((error) => {\n                console.log(error);\n              })\n              .finally(() => {\n                that.loading = false;\n              });\n          }\n        })\n        .catch((error) => {\n          console.log(error);\n        });\n    },\n    mostrarFormularioAbmMaterias() {\n      this.mostrarAbmMaterias = true;\n    },\n    agregarMateria() {\n      this.editar = false;\n      this.materiaSeleccionada = {};\n      this.mostrarFormularioAbmMaterias();\n    },\n    editarMateria(materia) {\n      this.materiaSeleccionada = {\n        id: materia.id,\n        nombre: materia.nombre,\n        cant_alumnos: materia.cant_alumnos,\n        id_carrera: materia.id_carrera,\n        id_profesor: materia.id_profesor,\n      };\n      this.editar = true;\n      this.mostrarAbmMaterias = true;\n    },\n    guardarAbmMateria() {\n      this.mostrarAbmMaterias = false;\n      this.obtenerListadoDeApi(); // Llama a la función después de guardar\n    },\n    eliminarMateria(materia) {\n      const that = this;\n      custom_axios\n        .delete(`/apiv1/materia/${materia.id}`)\n        .then((response) => {\n          console.log(response);\n          alert(\"Registro Eliminado!!\");\n        })\n        .catch((error) => {\n          console.log(error);\n        })\n        .finally(() => {\n          that.obtenerListadoDeApi(); // Asegúrate de que esta función se llame correctamente\n        });\n    },\n    cancelarAbmMateria() {\n      this.mostrarAbmMaterias = false;\n      this.materiaSeleccionada = {};\n    },\n  },\n  created() {\n    this.obtenerListadoDeApi(); // Asegúrate de que esta función se llame correctamente en el hook created\n  },\n};\n</script>\n\n<style scoped>\n.mr-2 {\n  margin-right: 8px;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}