{"ast":null,"code":"import \"core-js/modules/esnext.set.difference.v2.js\";\nimport \"core-js/modules/esnext.set.intersection.v2.js\";\nimport \"core-js/modules/esnext.set.is-disjoint-from.v2.js\";\nimport \"core-js/modules/esnext.set.is-subset-of.v2.js\";\nimport \"core-js/modules/esnext.set.is-superset-of.v2.js\";\nimport \"core-js/modules/esnext.set.symmetric-difference.v2.js\";\nimport \"core-js/modules/esnext.set.union.v2.js\";\nimport custom_axios from '../plugins/axios.js';\nimport AbmReservaAula from './AbmReservaAula.vue';\nexport default {\n  components: {\n    AbmReservaAula\n  },\n  data() {\n    return {\n      headers: [{\n        text: 'Aula',\n        value: 'aula_descripcion'\n      }, {\n        text: 'Fecha Hora Desde',\n        value: 'fh_desde'\n      }, {\n        text: 'Fecha Hora Hasta',\n        value: 'fh_hasta'\n      }, {\n        text: 'Observación',\n        value: 'observacion'\n      }, {\n        text: 'Acciones',\n        value: 'actions',\n        sortable: false\n      }],\n      listadoReservaAula: [],\n      mostrarAbmReservaAula: false,\n      mostrarConfirmacion: false,\n      reservaAulaSeleccionada: {},\n      reservaAulaAEliminar: null,\n      editar: false\n    };\n  },\n  methods: {\n    async todasLasReservasAula() {\n      try {\n        const response = await custom_axios.get('/apiv1/reservaaula');\n        if (response.status === 200) {\n          const reservas = response.data;\n          console.log('Reservas:', reservas);\n          const aulaIds = [...new Set(reservas.map(r => r.id_aula))];\n          const aulasResponse = await custom_axios.get('/apiv1/aula', {\n            params: {\n              ids: aulaIds.join(',')\n            }\n          });\n          const aulas = aulasResponse.data.reduce((acc, aula) => {\n            acc[aula.id] = aula;\n            return acc;\n          }, {});\n          console.log('Aulas:', aulas);\n          this.listadoReservaAula = reservas.map(reserva => {\n            return {\n              ...reserva,\n              aula_descripcion: aulas[reserva.id_aula] ? aulas[reserva.id_aula].descripcion : 'Sin aula'\n            };\n          });\n          console.log('Listado Reservas Aulas:', this.listadoReservaAula);\n        }\n      } catch (error) {\n        console.error(error);\n      }\n    },\n    abrirAbmReservaAula(editar, reserva = null) {\n      this.editar = editar;\n      this.reservaAulaSeleccionada = reserva || {\n        id: \"\",\n        id_aula: \"\",\n        fh_desde: \"\",\n        fh_hasta: \"\",\n        observacion: \"\"\n      };\n      this.mostrarAbmReservaAula = true;\n    },\n    guardarAbmReservaAula() {\n      this.todasLasReservasAula();\n      this.mostrarAbmReservaAula = false;\n    },\n    cancelarAbmReservaAula() {\n      this.mostrarAbmReservaAula = false;\n    },\n    confirmarEliminarReservaAula(reserva) {\n      this.reservaAulaAEliminar = reserva;\n      this.mostrarConfirmacion = true;\n    },\n    eliminarReservaAulaConfirmada() {\n      if (this.reservaAulaAEliminar) {\n        custom_axios.delete(`/apiv1/reservaaula/${this.reservaAulaAEliminar.id}`).then(response => {\n          if (response.status === 204) {\n            this.todasLasReservasAula();\n            this.mostrarConfirmacion = false;\n          }\n        }).catch(error => {\n          console.error(error);\n        });\n      }\n    }\n  },\n  created() {\n    this.todasLasReservasAula();\n  }\n};","map":{"version":3,"names":["custom_axios","AbmReservaAula","components","data","headers","text","value","sortable","listadoReservaAula","mostrarAbmReservaAula","mostrarConfirmacion","reservaAulaSeleccionada","reservaAulaAEliminar","editar","methods","todasLasReservasAula","response","get","status","reservas","console","log","aulaIds","Set","map","r","id_aula","aulasResponse","params","ids","join","aulas","reduce","acc","aula","id","reserva","aula_descripcion","descripcion","error","abrirAbmReservaAula","fh_desde","fh_hasta","observacion","guardarAbmReservaAula","cancelarAbmReservaAula","confirmarEliminarReservaAula","eliminarReservaAulaConfirmada","delete","then","catch","created"],"sources":["src/components/ListadoReservaAula.vue"],"sourcesContent":["<template>\n <div class=\"aula-container\">\n    <div class=\"button-container\">\n      <v-btn \n        color=\"primary\"\n        @click=\"navigateToAbmReservaAula\"\n        class=\"custom-button mr-4\"\n      >\n        <v-icon left>mdi-school</v-icon>\n        Agregar Reserva Aula\n      </v-btn>\n      <v-btn\n        color=\"blue\" \n        @click=\"navigateToHome\"\n        class=\"custom-button\"\n      >\n        <v-icon left>mdi-home</v-icon>\n        Volver a Home\n      </v-btn>\n    </div>\n\n    <v-data-table\n      :headers=\"headers\"\n      :items=\"listadoReservaAula\"\n      height=\"400\"\n      item-value=\"id\"\n    >\n      <template v-slot:item.actions=\"{ item }\">\n        <v-icon @click=\"abrirAbmReservaAula(true, item)\" class=\"mr-2\">mdi-pencil</v-icon>\n        <v-icon @click=\"confirmarEliminarReservaAula(item)\" class=\"ml-2\">mdi-delete</v-icon>\n      </template>\n    </v-data-table>\n\n    <v-dialog v-model=\"mostrarAbmReservaAula\" max-width=\"500px\" persistent>\n      <AbmReservaAula\n        :reserva=\"reservaAulaSeleccionada\"\n        :editar=\"editar\"\n        @guardar=\"guardarAbmReservaAula\"\n        @cancelar=\"cancelarAbmReservaAula\"\n      />\n    </v-dialog>\n\n    <v-dialog v-model=\"mostrarConfirmacion\" max-width=\"500px\">\n      <v-card>\n        <v-card-title class=\"headline\">Confirmar Eliminación</v-card-title>\n        <v-card-text>¿Está seguro de que desea eliminar la reserva de aula?</v-card-text>\n        <v-card-actions>\n          <v-spacer></v-spacer>\n          <v-btn color=\"green darken-1\" text @click=\"mostrarConfirmacion = false\">Cancelar</v-btn>\n          <v-btn color=\"red darken-1\" text @click=\"eliminarReservaAulaConfirmada\">Eliminar</v-btn>\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n  </div>\n</template>\n\n<script>\nimport custom_axios from '../plugins/axios.js';\nimport AbmReservaAula from './AbmReservaAula.vue';\n\nexport default {\n  components: {\n    AbmReservaAula,\n  },\n  data() {\n    return {\n      headers: [\n        { text: 'Aula', value: 'aula_descripcion' },\n        { text: 'Fecha Hora Desde', value: 'fh_desde' },\n        { text: 'Fecha Hora Hasta', value: 'fh_hasta' },\n        { text: 'Observación', value: 'observacion' },\n        { text: 'Acciones', value: 'actions', sortable: false },\n      ],\n      listadoReservaAula: [],\n      mostrarAbmReservaAula: false,\n      mostrarConfirmacion: false,\n      reservaAulaSeleccionada: {},\n      reservaAulaAEliminar: null,\n      editar: false,\n    };\n  },\n  methods: {\n    async todasLasReservasAula() {\n      try {\n        const response = await custom_axios.get('/apiv1/reservaaula');\n        if (response.status === 200) {\n          const reservas = response.data;\n          console.log('Reservas:', reservas); \n\n          const aulaIds = [...new Set(reservas.map(r => r.id_aula))];\n          const aulasResponse = await custom_axios.get('/apiv1/aula', { params: { ids: aulaIds.join(',') } });\n          const aulas = aulasResponse.data.reduce((acc, aula) => {\n            acc[aula.id] = aula;\n            return acc;\n          }, {});\n\n          console.log('Aulas:', aulas); \n\n          this.listadoReservaAula = reservas.map(reserva => {\n            return {\n              ...reserva,\n              aula_descripcion: aulas[reserva.id_aula] ? aulas[reserva.id_aula].descripcion : 'Sin aula',\n            };\n          });\n\n          console.log('Listado Reservas Aulas:', this.listadoReservaAula); \n        }\n      } catch (error) {\n        console.error(error);\n      }\n    },\n    abrirAbmReservaAula(editar, reserva = null) {\n      this.editar = editar;\n      this.reservaAulaSeleccionada = reserva || { id: \"\", id_aula: \"\", fh_desde: \"\", fh_hasta: \"\", observacion: \"\" };\n      this.mostrarAbmReservaAula = true;\n    },\n    guardarAbmReservaAula() {\n      this.todasLasReservasAula();\n      this.mostrarAbmReservaAula = false;\n    },\n    cancelarAbmReservaAula() {\n      this.mostrarAbmReservaAula = false;\n    },\n    confirmarEliminarReservaAula(reserva) {\n      this.reservaAulaAEliminar = reserva;\n      this.mostrarConfirmacion = true;\n    },\n    eliminarReservaAulaConfirmada() {\n      if (this.reservaAulaAEliminar) {\n        custom_axios\n          .delete(`/apiv1/reservaaula/${this.reservaAulaAEliminar.id}`)\n          .then(response => {\n            if (response.status === 204) {\n              this.todasLasReservasAula();\n              this.mostrarConfirmacion = false;\n            }\n          })\n          .catch(error => {\n            console.error(error);\n          });\n      }\n    },\n  },\n  created() {\n    this.todasLasReservasAula();\n  },\n};\n</script>\n\n<style scoped>\n.mr-2 {\n  margin-right: 8px;\n}\n.ml-2 {\n  margin-left: 8px;\n}\n</style>\n"],"mappings":";;;;;;;AAyDA,OAAAA,YAAA;AACA,OAAAC,cAAA;AAEA;EACAC,UAAA;IACAD;EACA;EACAE,KAAA;IACA;MACAC,OAAA,GACA;QAAAC,IAAA;QAAAC,KAAA;MAAA,GACA;QAAAD,IAAA;QAAAC,KAAA;MAAA,GACA;QAAAD,IAAA;QAAAC,KAAA;MAAA,GACA;QAAAD,IAAA;QAAAC,KAAA;MAAA,GACA;QAAAD,IAAA;QAAAC,KAAA;QAAAC,QAAA;MAAA,EACA;MACAC,kBAAA;MACAC,qBAAA;MACAC,mBAAA;MACAC,uBAAA;MACAC,oBAAA;MACAC,MAAA;IACA;EACA;EACAC,OAAA;IACA,MAAAC,qBAAA;MACA;QACA,MAAAC,QAAA,SAAAhB,YAAA,CAAAiB,GAAA;QACA,IAAAD,QAAA,CAAAE,MAAA;UACA,MAAAC,QAAA,GAAAH,QAAA,CAAAb,IAAA;UACAiB,OAAA,CAAAC,GAAA,cAAAF,QAAA;UAEA,MAAAG,OAAA,WAAAC,GAAA,CAAAJ,QAAA,CAAAK,GAAA,CAAAC,CAAA,IAAAA,CAAA,CAAAC,OAAA;UACA,MAAAC,aAAA,SAAA3B,YAAA,CAAAiB,GAAA;YAAAW,MAAA;cAAAC,GAAA,EAAAP,OAAA,CAAAQ,IAAA;YAAA;UAAA;UACA,MAAAC,KAAA,GAAAJ,aAAA,CAAAxB,IAAA,CAAA6B,MAAA,EAAAC,GAAA,EAAAC,IAAA;YACAD,GAAA,CAAAC,IAAA,CAAAC,EAAA,IAAAD,IAAA;YACA,OAAAD,GAAA;UACA;UAEAb,OAAA,CAAAC,GAAA,WAAAU,KAAA;UAEA,KAAAvB,kBAAA,GAAAW,QAAA,CAAAK,GAAA,CAAAY,OAAA;YACA;cACA,GAAAA,OAAA;cACAC,gBAAA,EAAAN,KAAA,CAAAK,OAAA,CAAAV,OAAA,IAAAK,KAAA,CAAAK,OAAA,CAAAV,OAAA,EAAAY,WAAA;YACA;UACA;UAEAlB,OAAA,CAAAC,GAAA,iCAAAb,kBAAA;QACA;MACA,SAAA+B,KAAA;QACAnB,OAAA,CAAAmB,KAAA,CAAAA,KAAA;MACA;IACA;IACAC,oBAAA3B,MAAA,EAAAuB,OAAA;MACA,KAAAvB,MAAA,GAAAA,MAAA;MACA,KAAAF,uBAAA,GAAAyB,OAAA;QAAAD,EAAA;QAAAT,OAAA;QAAAe,QAAA;QAAAC,QAAA;QAAAC,WAAA;MAAA;MACA,KAAAlC,qBAAA;IACA;IACAmC,sBAAA;MACA,KAAA7B,oBAAA;MACA,KAAAN,qBAAA;IACA;IACAoC,uBAAA;MACA,KAAApC,qBAAA;IACA;IACAqC,6BAAAV,OAAA;MACA,KAAAxB,oBAAA,GAAAwB,OAAA;MACA,KAAA1B,mBAAA;IACA;IACAqC,8BAAA;MACA,SAAAnC,oBAAA;QACAZ,YAAA,CACAgD,MAAA,4BAAApC,oBAAA,CAAAuB,EAAA,IACAc,IAAA,CAAAjC,QAAA;UACA,IAAAA,QAAA,CAAAE,MAAA;YACA,KAAAH,oBAAA;YACA,KAAAL,mBAAA;UACA;QACA,GACAwC,KAAA,CAAAX,KAAA;UACAnB,OAAA,CAAAmB,KAAA,CAAAA,KAAA;QACA;MACA;IACA;EACA;EACAY,QAAA;IACA,KAAApC,oBAAA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}