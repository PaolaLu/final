{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.set.difference.v2.js\";\nimport \"core-js/modules/esnext.set.intersection.v2.js\";\nimport \"core-js/modules/esnext.set.is-disjoint-from.v2.js\";\nimport \"core-js/modules/esnext.set.is-subset-of.v2.js\";\nimport \"core-js/modules/esnext.set.is-superset-of.v2.js\";\nimport \"core-js/modules/esnext.set.symmetric-difference.v2.js\";\nimport \"core-js/modules/esnext.set.union.v2.js\";\nimport custom_axios from '../plugins/axios.js';\nimport AbmMateria from './AbmMateria.vue';\nexport default {\n  components: {\n    AbmMateria\n  },\n  data() {\n    return {\n      headers: [{\n        text: 'Nombre',\n        value: 'nombre'\n      }, {\n        text: 'Cantidad de Alumnos',\n        value: 'cant_alumnos'\n      }, {\n        text: 'Carrera',\n        value: 'carrera'\n      }, {\n        text: 'Profesor',\n        value: 'profesor'\n      }, {\n        text: 'Acciones',\n        value: 'actions',\n        sortable: false\n      }],\n      listadoMaterias: [],\n      mostrarAbmMateria: false,\n      mostrarConfirmacion: false,\n      materiaSeleccionada: {},\n      materiaAEliminar: null,\n      editar: false\n    };\n  },\n  methods: {\n    async todasLasMaterias() {\n      try {\n        const response = await custom_axios.get('/apiv1/materia');\n        if (response.status === 200) {\n          const materias = response.data;\n          console.log('Materias:', materias);\n\n          // ID de carreras y profesores\n          const carreraIds = [...new Set(materias.map(m => m.id_carrera))];\n          const profesorIds = [...new Set(materias.map(m => m.id_profesor))];\n\n          // datos de todas las carreras y profesores\n          const [carrerasResponse, profesoresResponse] = await Promise.all([custom_axios.get('/apiv1/carrera', {\n            params: {\n              ids: carreraIds.join(',')\n            }\n          }), custom_axios.get('/apiv1/profesor', {\n            params: {\n              ids: profesorIds.join(',')\n            }\n          })]);\n          const carreras = carrerasResponse.data.reduce((acc, carrera) => {\n            acc[carrera.id] = carrera;\n            return acc;\n          }, {});\n          const profesores = profesoresResponse.data.reduce((acc, profesor) => {\n            acc[profesor.id] = profesor;\n            return acc;\n          }, {});\n          this.listadoMaterias = materias.map(materia => {\n            return {\n              ...materia,\n              carrera: carreras[materia.id_carrera] ? carreras[materia.id_carrera].nombre : 'Sin carrera',\n              profesor: profesores[materia.id_profesor] ? profesores[materia.id_profesor].apellido : 'Sin profesor'\n            };\n          });\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n    navigateToAbmMateria() {\n      this.$router.push('/abmmateria');\n    },\n    navigateToHome() {\n      this.$router.push('/');\n    },\n    editarMateria(item) {\n      this.materiaSeleccionada = {\n        ...item\n      };\n      this.editar = true;\n      this.mostrarAbmMateria = true;\n    },\n    confirmarEliminarMateria(item) {\n      this.materiaAEliminar = item;\n      this.mostrarConfirmacion = true;\n    },\n    eliminarMateriaConfirmada() {\n      custom_axios.delete(`/apiv1/materia/${this.materiaAEliminar.id}`).then(response => {\n        if (response.status === 204) {\n          this.todasLasMaterias();\n          this.mostrarConfirmacion = false;\n        }\n      }).catch(error => {\n        console.log(error);\n      });\n    },\n    guardarAbmMateria() {\n      this.mostrarAbmMateria = false;\n      this.todasLasMaterias();\n    },\n    cancelarAbmMateria() {\n      this.mostrarAbmMateria = false;\n      this.$router.push('/abmmateria');\n    }\n  },\n  mounted() {\n    this.todasLasMaterias();\n  }\n};","map":{"version":3,"names":["custom_axios","AbmMateria","components","data","headers","text","value","sortable","listadoMaterias","mostrarAbmMateria","mostrarConfirmacion","materiaSeleccionada","materiaAEliminar","editar","methods","todasLasMaterias","response","get","status","materias","console","log","carreraIds","Set","map","m","id_carrera","profesorIds","id_profesor","carrerasResponse","profesoresResponse","Promise","all","params","ids","join","carreras","reduce","acc","carrera","id","profesores","profesor","materia","nombre","apellido","error","navigateToAbmMateria","$router","push","navigateToHome","editarMateria","item","confirmarEliminarMateria","eliminarMateriaConfirmada","delete","then","catch","guardarAbmMateria","cancelarAbmMateria","mounted"],"sources":["src/components/ListadoMateria.vue"],"sourcesContent":["<template>\n  <div class=\"aula-container\">\n    <div class=\"button-container\">\n      \n      <v-btn \n        color=\"primary\"\n        @click=\"navigateToAbmMateria\"\n        class=\"custom-button mr-4\"\n      >\n        <v-icon left>mdi-school</v-icon>\n        Agregar Materia\n      </v-btn>\n      \n      <v-btn\n        color=\"blue\" \n\n        @click=\"navigateToHome\"\n        class=\"custom-button\"\n      >\n        <v-icon left>mdi-home</v-icon>\n        Volver a Home\n      </v-btn>\n    </div>\n\n    <v-data-table\n      :headers=\"headers\"\n      :items=\"listadoMaterias\"\n      height=\"400\"\n      item-value=\"name\"\n    >\n      <template v-slot:item.actions=\"{ item }\">\n        <v-icon color=\"green\" @click=\"editarMateria(item)\" class=\"mr-2\">mdi-pencil</v-icon>\n        <v-icon color=\"red\" @click=\"confirmarEliminarMateria(item)\" class=\"ml-2\">mdi-delete</v-icon>\n      </template>\n    </v-data-table>\n\n    <v-dialog v-model=\"mostrarAbmMateria\" max-width=\"500px\" persistent>\n      <AbmMateria\n        :materia=\"materiaSeleccionada\"\n        :editar=\"editar\"\n        @guardar=\"guardarAbmMateria\"\n        @cancelar=\"cancelarAbmMateria\"\n      />\n    </v-dialog>\n\n    <v-dialog v-model=\"mostrarConfirmacion\" max-width=\"500px\">\n      <v-card>\n        <v-card-title class=\"headline\">Confirmar Eliminación</v-card-title>\n        <v-card-text>¿Está seguro de que desea eliminar esta materia?</v-card-text>\n        <v-card-actions>\n          <v-spacer></v-spacer>\n          <v-btn color=\"green darken-1\" text @click=\"mostrarConfirmacion = false\">Cancelar</v-btn>\n          <v-btn color=\"red darken-1\" text @click=\"eliminarMateriaConfirmada\">Eliminar</v-btn>\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n  </div>\n</template>\n\n<script>\nimport custom_axios from '../plugins/axios.js';\nimport AbmMateria from './AbmMateria.vue';\n\nexport default {\n  components: {\n    AbmMateria,\n  },\n  data() {\n    return {\n      headers: [\n        { text: 'Nombre', value: 'nombre' },\n        { text: 'Cantidad de Alumnos', value: 'cant_alumnos' },\n        { text: 'Carrera', value: 'carrera' }, \n        { text: 'Profesor', value: 'profesor' }, \n        { text: 'Acciones', value: 'actions', sortable: false },\n      ],\n      listadoMaterias: [],\n      mostrarAbmMateria: false,\n      mostrarConfirmacion: false,\n      materiaSeleccionada: {},\n      materiaAEliminar: null,\n      editar: false,\n    };\n  },\n  methods: {\n    async todasLasMaterias() {\n      try {\n        const response = await custom_axios\n        .get('/apiv1/materia');\n        if (response.status === 200) {\n          const materias = response.data;\n          console.log('Materias:', materias); \n\n          // ID de carreras y profesores\n          const carreraIds = [...new Set(materias.map(m => m.id_carrera))];\n          const profesorIds = [...new Set(materias.map(m => m.id_profesor))];\n\n          // datos de todas las carreras y profesores\n          const [carrerasResponse, profesoresResponse] = await Promise.all([\n            custom_axios.get('/apiv1/carrera', { params: { ids: carreraIds.join(',') } }),\n            custom_axios.get('/apiv1/profesor', { params: { ids: profesorIds.join(',') } }),\n          ]);\n\n          const carreras = carrerasResponse.data.reduce((acc, carrera) => {\n            acc[carrera.id] = carrera;\n            return acc;\n          }, {});\n\n          const profesores = profesoresResponse.data.reduce((acc, profesor) => {\n            acc[profesor.id] = profesor;\n            return acc;\n          }, {});\n\n          this.listadoMaterias = materias.map(materia => {\n            return {\n              ...materia,\n              carrera: carreras[materia.id_carrera] ? carreras[materia.id_carrera].nombre : 'Sin carrera',\n              profesor: profesores[materia.id_profesor] ? profesores[materia.id_profesor].apellido : 'Sin profesor',\n            };\n          });\n\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n    navigateToAbmMateria() {\n      this.$router.push('/abmmateria');\n    },\n    navigateToHome() {\n      this.$router.push('/');\n    },\n    editarMateria(item) {\n      this.materiaSeleccionada = { ...item };\n      this.editar = true;\n      this.mostrarAbmMateria = true;\n    },\n    confirmarEliminarMateria(item) {\n      this.materiaAEliminar = item;\n      this.mostrarConfirmacion = true;\n    },\n    eliminarMateriaConfirmada() {\n      custom_axios\n        .delete(`/apiv1/materia/${this.materiaAEliminar.id}`)\n        .then(response => {\n          if (response.status === 204) {\n            this.todasLasMaterias();\n            this.mostrarConfirmacion = false;\n          }\n        })\n        .catch(error => {\n          console.log(error);\n        });\n    },\n    guardarAbmMateria() {\n      this.mostrarAbmMateria = false;\n      this.todasLasMaterias();\n    },\n    cancelarAbmMateria() {\n      this.mostrarAbmMateria = false;\n      this.$router.push('/abmmateria');\n    },\n  },\n  mounted() {\n    this.todasLasMaterias();\n  },\n};\n</script>\n\n<style scoped>\n.mr-2 {\n  margin-right: 8px;\n}\n.ml-2 {\n  margin-left: 8px;\n}\n</style>\n\n\n\n<style scoped>\n.mr-2 {\n  margin-right: 8px;\n}\n.ml-2 {\n  margin-left: 8px;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}