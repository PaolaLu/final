{"ast":null,"code":"import custom_axios from '../plugins/axios.js';\nexport default {\n  props: {\n    reserva: {\n      type: Object,\n      default: () => ({\n        id: \"\",\n        id_aula: \"\",\n        fh_desde: \"\",\n        fh_hasta: \"\",\n        observacion: \"\"\n      })\n    },\n    editar: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      valid: false,\n      reservaData: {\n        id_aula: \"\",\n        fh_desde: \"\",\n        fh_hasta: \"\",\n        observacion: \"\"\n      },\n      aulas: [],\n      aulaRules: [v => !!v || 'El aula es requerida'],\n      fechaDesdeRules: [v => !!v || 'La fecha de inicio es requerida'],\n      fechaHastaRules: [v => !!v || 'La fecha de fin es requerida'],\n      observacionRules: [v => !!v || 'Las observaciones son requeridas'],\n      menuDesde: false,\n      menuHasta: false,\n      aulasLoading: false,\n      aulasError: ''\n    };\n  },\n  watch: {\n    reserva: {\n      handler(nuevoValor) {\n        this.reservaData = {\n          ...nuevoValor\n        };\n        if (!this.editar) {\n          this.resetValidation();\n        }\n      },\n      deep: true\n    }\n  },\n  methods: {\n    submit() {\n      // Validar el formulario antes de enviar\n      this.$refs.form.validate();\n      if (this.valid) {\n        if (this.editar) {\n          this.editarReserva();\n        } else {\n          this.guardarReserva();\n        }\n      }\n    },\n    guardarReserva() {\n      custom_axios.post('/apiv1/reservaaula', this.reservaData).then(response => {\n        this.$emit('guardar');\n        this.$emit('cerrar');\n      }).catch(error => {\n        console.error('Error guardando reserva:', error);\n      });\n    },\n    editarReserva() {\n      custom_axios.patch(`/apiv1/reservaaula/${this.reservaData.id}`, this.reservaData).then(response => {\n        this.$emit('guardar');\n        this.$emit('cerrar');\n        this.$emit('actualizar');\n      }).catch(error => {\n        console.error(error);\n      });\n    },\n    cancelar() {\n      this.$emit('cancelar');\n    },\n    resetValidation() {\n      if (this.$refs.form) {\n        this.$refs.form.resetValidation();\n      }\n    },\n    obtenerAulas() {\n      this.aulasLoading = true;\n      this.aulasError = '';\n      custom_axios.get('/apiv1/aula').then(response => {\n        this.aulas = response.data;\n      }).catch(error => {\n        this.aulasError = 'Error obteniendo aulas';\n        console.error('Error obteniendo aulas:', error);\n      }).finally(() => {\n        this.aulasLoading = false;\n      });\n    }\n  },\n  created() {\n    this.obtenerAulas();\n    if (this.reserva) {\n      this.reservaData = {\n        ...this.reserva\n      };\n    }\n  }\n};","map":{"version":3,"names":["custom_axios","props","reserva","type","Object","default","id","id_aula","fh_desde","fh_hasta","observacion","editar","Boolean","data","valid","reservaData","aulas","aulaRules","v","fechaDesdeRules","fechaHastaRules","observacionRules","menuDesde","menuHasta","aulasLoading","aulasError","watch","handler","nuevoValor","resetValidation","deep","methods","submit","$refs","form","validate","editarReserva","guardarReserva","post","then","response","$emit","catch","error","console","patch","cancelar","obtenerAulas","get","finally","created"],"sources":["src/components/AbmReservaAula.vue"],"sourcesContent":["<template>\n    <v-form ref=\"form\" v-model=\"valid\" @submit.prevent=\"submit\">\n      <v-card>\n        <v-card-title>{{ editar ? 'Editar Reserva de Aula' : 'Agregar Reserva de Aula' }}</v-card-title>\n        <v-card-text>\n          <v-select\n            v-model=\"reservaData.id_aula\"\n            :items=\"aulas\"\n            item-text=\"descripcion\"\n            item-value=\"id\"\n            label=\"Aula\"\n            :rules=\"aulaRules\"\n            required\n          ></v-select>\n          <v-row>\n            <v-col cols=\"12\">\n              <v-menu\n                ref=\"desdeMenu\"\n                v-model=\"menuDesde\"\n                :close-on-content-click=\"false\"\n                transition=\"scale-transition\"\n                offset-y\n                min-width=\"290px\"\n              >\n                <template v-slot:activator=\"{ on, attrs }\">\n                  <v-text-field\n                    v-model=\"reservaData.fh_desde\"\n                    label=\"Fecha de Inicio\"\n                    prepend-icon=\"mdi-calendar\"\n                    readonly\n                    v-bind=\"attrs\"\n                    v-on=\"on\"\n                    :rules=\"fechaDesdeRules\"\n                    required\n                  ></v-text-field>\n                </template>\n                <v-date-picker v-model=\"reservaData.fh_desde\" @input=\"menuDesde = false\"></v-date-picker>\n              </v-menu>\n            </v-col>\n          </v-row>\n  \n          <!-- Fecha de Fin -->\n          <v-row>\n            <v-col cols=\"12\">\n              <v-menu\n                ref=\"hastaMenu\"\n                v-model=\"menuHasta\"\n                :close-on-content-click=\"false\"\n                transition=\"scale-transition\"\n                offset-y\n                min-width=\"290px\"\n              >\n                <template v-slot:activator=\"{ on, attrs }\">\n                  <v-text-field\n                    v-model=\"reservaData.fh_hasta\"\n                    label=\"Fecha de Fin\"\n                    prepend-icon=\"mdi-calendar\"\n                    readonly\n                    v-bind=\"attrs\"\n                    v-on=\"on\"\n                    :rules=\"fechaHastaRules\"\n                    required\n                  ></v-text-field>\n                </template>\n                <v-date-picker v-model=\"reservaData.fh_hasta\" @input=\"menuHasta = false\"></v-date-picker>\n              </v-menu>\n            </v-col>\n          </v-row>\n  \n          <!-- Observaciones -->\n          <v-text-field\n            v-model=\"reservaData.observacion\"\n            label=\"Observaciones\"\n            :rules=\"observacionRules\"\n            required\n          ></v-text-field>\n        </v-card-text>\n        <v-card-actions>\n          <v-btn color=\"primary\" @click=\"submit\" :disabled=\"!valid\">Guardar</v-btn>\n          <v-btn color=\"secondary\" @click=\"cancelar\">Cancelar</v-btn>\n        </v-card-actions>\n      </v-card>\n    </v-form>\n  </template>\n  \n  <script>\n  import custom_axios from '../plugins/axios.js';\n  \n  export default {\n    props: {\n      reserva: {\n        type: Object,\n        default: () => ({ id: \"\", id_aula: \"\", fh_desde: \"\", fh_hasta: \"\", observacion: \"\" }),\n      },\n      editar: {\n        type: Boolean,\n        default: false,\n      },\n    },\n    data() {\n      return {\n        valid: false,\n        reservaData: {\n          id_aula: \"\",\n          fh_desde: \"\",\n          fh_hasta: \"\",\n          observacion: \"\",\n        },\n        aulas: [],\n        aulaRules: [(v) => !!v || 'El aula es requerida'],\n        fechaDesdeRules: [(v) => !!v || 'La fecha de inicio es requerida'],\n        fechaHastaRules: [(v) => !!v || 'La fecha de fin es requerida'],\n        observacionRules: [(v) => !!v || 'Las observaciones son requeridas'],\n        menuDesde: false,\n        menuHasta: false,\n        aulasLoading: false,\n        aulasError: '',\n      };\n    },\n    watch: {\n      reserva: {\n        handler(nuevoValor) {\n          this.reservaData = { ...nuevoValor };\n          if (!this.editar) {\n            this.resetValidation();\n          }\n        },\n        deep: true,\n      },\n    },\n    methods: {\n      submit() {\n        // Validar el formulario antes de enviar\n        this.$refs.form.validate();\n        if (this.valid) {\n          if (this.editar) {\n            this.editarReserva();\n          } else {\n            this.guardarReserva();\n          }\n        }\n      },\n      guardarReserva() {\n        custom_axios\n          .post('/apiv1/reservaaula', this.reservaData)\n          .then((response) => {\n            this.$emit('guardar');\n            this.$emit('cerrar');\n          })\n          .catch((error) => {\n            console.error('Error guardando reserva:', error);\n          });\n      },\n      editarReserva() {\n        custom_axios\n          .patch(`/apiv1/reservaaula/${this.reservaData.id}`, this.reservaData)\n          .then((response) => {\n            this.$emit('guardar');\n            this.$emit('cerrar');\n            this.$emit('actualizar');\n          })\n          .catch((error) => {\n            console.error(error);\n          });\n      },\n      cancelar() {\n        this.$emit('cancelar');\n      },\n      resetValidation() {\n        if (this.$refs.form) {\n          this.$refs.form.resetValidation();\n        }\n      },\n      obtenerAulas() {\n        this.aulasLoading = true;\n        this.aulasError = '';\n        custom_axios\n          .get('/apiv1/aula')\n          .then((response) => {\n            this.aulas = response.data;\n          })\n          .catch((error) => {\n            this.aulasError = 'Error obteniendo aulas';\n            console.error('Error obteniendo aulas:', error);\n          })\n          .finally(() => {\n            this.aulasLoading = false;\n          });\n      },\n    },\n    created() {\n      this.obtenerAulas();\n      if (this.reserva) {\n        this.reservaData = { ...this.reserva };\n      }\n    },\n  };\n  </script>\n  \n  <style scoped>\n  .mr-2 {\n    margin-right: 8px;\n  }\n  .ml-2 {\n    margin-left: 8px;\n  }\n  </style>\n  "],"mappings":"AAsFA,OAAAA,YAAA;AAEA;EACAC,KAAA;IACAC,OAAA;MACAC,IAAA,EAAAC,MAAA;MACAC,OAAA,EAAAA,CAAA;QAAAC,EAAA;QAAAC,OAAA;QAAAC,QAAA;QAAAC,QAAA;QAAAC,WAAA;MAAA;IACA;IACAC,MAAA;MACAR,IAAA,EAAAS,OAAA;MACAP,OAAA;IACA;EACA;EACAQ,KAAA;IACA;MACAC,KAAA;MACAC,WAAA;QACAR,OAAA;QACAC,QAAA;QACAC,QAAA;QACAC,WAAA;MACA;MACAM,KAAA;MACAC,SAAA,GAAAC,CAAA,MAAAA,CAAA;MACAC,eAAA,GAAAD,CAAA,MAAAA,CAAA;MACAE,eAAA,GAAAF,CAAA,MAAAA,CAAA;MACAG,gBAAA,GAAAH,CAAA,MAAAA,CAAA;MACAI,SAAA;MACAC,SAAA;MACAC,YAAA;MACAC,UAAA;IACA;EACA;EACAC,KAAA;IACAxB,OAAA;MACAyB,QAAAC,UAAA;QACA,KAAAb,WAAA;UAAA,GAAAa;QAAA;QACA,UAAAjB,MAAA;UACA,KAAAkB,eAAA;QACA;MACA;MACAC,IAAA;IACA;EACA;EACAC,OAAA;IACAC,OAAA;MACA;MACA,KAAAC,KAAA,CAAAC,IAAA,CAAAC,QAAA;MACA,SAAArB,KAAA;QACA,SAAAH,MAAA;UACA,KAAAyB,aAAA;QACA;UACA,KAAAC,cAAA;QACA;MACA;IACA;IACAA,eAAA;MACArC,YAAA,CACAsC,IAAA,4BAAAvB,WAAA,EACAwB,IAAA,CAAAC,QAAA;QACA,KAAAC,KAAA;QACA,KAAAA,KAAA;MACA,GACAC,KAAA,CAAAC,KAAA;QACAC,OAAA,CAAAD,KAAA,6BAAAA,KAAA;MACA;IACA;IACAP,cAAA;MACApC,YAAA,CACA6C,KAAA,4BAAA9B,WAAA,CAAAT,EAAA,SAAAS,WAAA,EACAwB,IAAA,CAAAC,QAAA;QACA,KAAAC,KAAA;QACA,KAAAA,KAAA;QACA,KAAAA,KAAA;MACA,GACAC,KAAA,CAAAC,KAAA;QACAC,OAAA,CAAAD,KAAA,CAAAA,KAAA;MACA;IACA;IACAG,SAAA;MACA,KAAAL,KAAA;IACA;IACAZ,gBAAA;MACA,SAAAI,KAAA,CAAAC,IAAA;QACA,KAAAD,KAAA,CAAAC,IAAA,CAAAL,eAAA;MACA;IACA;IACAkB,aAAA;MACA,KAAAvB,YAAA;MACA,KAAAC,UAAA;MACAzB,YAAA,CACAgD,GAAA,gBACAT,IAAA,CAAAC,QAAA;QACA,KAAAxB,KAAA,GAAAwB,QAAA,CAAA3B,IAAA;MACA,GACA6B,KAAA,CAAAC,KAAA;QACA,KAAAlB,UAAA;QACAmB,OAAA,CAAAD,KAAA,4BAAAA,KAAA;MACA,GACAM,OAAA;QACA,KAAAzB,YAAA;MACA;IACA;EACA;EACA0B,QAAA;IACA,KAAAH,YAAA;IACA,SAAA7C,OAAA;MACA,KAAAa,WAAA;QAAA,QAAAb;MAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}